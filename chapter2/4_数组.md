# 数组

数组与vector不同的地方是，有固定大小，不能随意向数组添加元素。

## 定义和初始化内置数组

数组是一种复合类型。数组的声明`a[d]`,a是名称，d是维度，必须大于0。数组中元素的个数也属于数组类型的一部分，编译时维度应该已知,因此维度必须时常量表达式。

```c++
unsigned cnt = 42;
constexpr unsigned sz = 42;
int arr[10]; // 会默认初始化数组
int* parr[sz];
string bad[cnt]; // 维度不是常量，错误
```

- 显示初始化数组元素
```c++
const unsigned sz = 3;
int ial[sz] = { 0, 1, 2 };
int a2[] = { 0, 1, 2 }; // 这种情况，会自动推断数组长度
int a3[5] = { 0, 1, 2 }; // 多出的未指定的元素会进行默认初始化
string a4[3] = { "hi", "bye" };
```
- 字符数组的特殊性
```c++
char c1[] = { 'C', '+', '+' }; // 长度为3
char c2[] = "C++"; // 长度为4，因此字符串末尾有一个空字符
```
- 不允许拷贝和赋值
> 即 `int a2[] = a`这种方法时错误的。

- 复杂数组的声明
和vector一样，数组能存放大多数类型的对象，如存放指针的数组。但由于数组本身就是对象，所以允许定义数组的指针及数组的引用。
```c++
int* ptrs[10]; //指针的数组
int& refs[10]; // 错误，引用不是对象，所以不能作为数组的元素
int(*Parray)[3] = &ial; // 指针指向一个包含3的元素的数组
int(&arrRef)[3] = ial; // 引用指向一个包含3的元素的数组
```
> 阅读顺序，由内向外，由右向左

## 访问数组元素

数组通过下标访问，类型为`size_t`,vector时`size_type`，足够大以便访问内存中任意大小的对象。  
数组除了大小固定外，其他的用法与vector基本类似。，也支持for运算
```c++
for (auto i : scores)
    cout << i << endl;
```

## 指针和数组

指针和数组有紧密的联系。使用数组类型的对象其实是使用一个指向该数组首元素的指针。
```
int a = {1, 2, 3};
auto a2 = a; // a2是指向a[0]的指针
```

- 指针也是迭代器  
数组的指针支持++操作，可以使用指针遍历数组元素。
```c++
int* e = &aa[10]; // 模拟end
for (int* b = aa; b != e; ++b) {
	cout << *b << endl;
}
```

- 标准库函数begin和end  
C++11，引入的两个函数。这两个函数与容器中的成员函数功能类似。
```c++
# include<iterator>
int ia[] = { 0, 1, 2, 3, 4, 5, 6, 7, 8 };
int* beg = begin(ia);
int* last = end(ia);
```

- 指针运算  
指向数组元素的指针可以执行迭代器的所有运算。解引用，递增，比较，与整数相加，两个指针相减等。
> 两个指针相减的结果是`ptrdiff_t`类型。有符号，可以为负。

- 解引用与指针运算结合

```c++
int last1 = *(ia + 4); // ia[4]
int last2 = *ia + 4; // ia[0] + 4
cout << last1 << " " << last2 << endl;
```

## C风格字符串
字符数组，以空字符结束。在`cstring`中定义了一些常用操作。
| | |
| --- | --- |
| strlen(p) | 返回p的长度，空字符不计算在内 |
| strcmp(p1, p2) | 比较p1和p2的相等性。如果p1==p2,返回0,大于返回正值 |
| strcat(p1, p2) | 将p2附加到p1之后，返回p1 |
| strcpy(p1, p2) | 将p2拷贝给p1,返回p1 |

# 多维数组

指的是数组的数组，当一个数组的元素仍然是数组时，通常使用两个维度来定义它：一个维度表示数组本身大小，另一个表示其元素的大小。
```c++
int iia[3][4];
```

- 多维数组的初始化  
允许使用花括号括起来的一组值初始化多维数组。内层嵌套的花括号并非必须的。
```c++
int iaa[3][4] = {
	{0, 1, 2, 3},
	{4,5,6,7},
	{8, 9, 10, 11}
};
```
- 使用范围for
```c++
for (auto& row : iaa) {
	for (auto& col : row) {
		cout << col;
	}
}
```
> 使用范围for语句处理多维数组，除了最内层的循环外，其他所有循环的控制变量都应该时引用类型。直接用名字会变成指向首元素的指针

- 指针和多维数组  
当程序使用多维数组的名字时，也会自动将其转换成指向数组首元素的指针。
因为多维数组实际上是数组的数组，所以由多维数组名转换得来的指针实际上指向第一个内层数组的指针。
```c++
for (auto p = iaa; p != iaa + 3; ++p) {
	for (auto q = *p; q != *p + 4; ++q) {
		cout << *q << ' ';
	}
}
```
```c++
for (auto p = begin(iaa); p != end(iaa); ++p) {
	for (auto q = begin(*p); q != end(*p); q++) {
		cout << *q << endl;
	}
}
```